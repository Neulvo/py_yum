 # nsmc_project

- Kim yoon 의 CNN을 활용한 Text classification 구현
- 모델 코드는 https://github.com/diegoschapira/CNN-Text-Classifier-using-Keras/blob/master/models.py 를 참고했다.
- Tokenize 방법에 따라 3개의 분류
  - Base (split by (' '))
  - Okt (tokenized by okt)
  - Mecab (tokenized by mecab)
- 학습 방법에 따라 3개의 분류
  - Contextual
    - 가중치 행렬 없이 학습
  - Static (with Wiki = fasttext vec)
    - 벡터화된 단어 사전을 가지고 학습
  - Non-Static (with full sentences)
    - 네이버 영화 리뷰 전체 데이터를 가지고 벡터화(Word2Vec 생성)
- 실행
  - 순서대로 하나 하나 실행시켜보면 된다.
  - Base, Okt, Mecab에 따라 Tokenize가 재정의되었기 때문에 건너뛴다면 다른 결과가 나올 수 있다.
  - 건너뛰고 싶다면 적어도 각 분류의 학습 포맷 맞추기 부분은 실행해줘라.
- 모델 설명
  - vocab_size = len(word_index)+1 : 0 index를 포함하기 위해 +1
  - embedding_dim = 300 : 벡터 차원을 300으로 설정
  - input_length = max_len : 단어의 최대길이를 활용
  - trainable = False : 재학습 방지
  - weights = [embedding_matrix] : 벡터화된 행렬을 가중치로 활용
  - filter_sizes = [3,4,5] : Con1D에 각각의 필터 사이즈 적용
  - Concatenate 로 위의 필터 적용된 것을 합쳐줌.
  - kernel_regularizer = l2(1e-3) : L2 규제, 1e-3
  - Dropout(0.5) : Dropout 0.5 만큼 규제를 주었다.

- 모델 성능 (by val-acc)
  - Base 모델
    - Base_Contextual : 0.7495
    - Base_Static : 0.7374
    - Base_Non-Static : 0.7478
  - Okt 모델
    - Okt_Contextual : 0.7485
    - Okt_Static : 0.7543
    - Okt_Non-Static : 0.6863
  - Mecab 모델
    - Mecab_Contextual : 0.7957
    - Mecab_Static : 0.7670
    - Mecab_Non-Static : 0.7170
  - 평가
    - 모델 중에선 Mecab의 성능이 좋게 나온다.
    - Okt, Mecab 의 Non-Static 모델 성능이 안좋은데 이것은 OOV를 제외했기 때문인 듯하다.
- 예측 성능 (by random sentence)
  - 전반적으로 예측 성능이 좋지 못하게 나왔다.
  - 단어 사전에서의 단어 존재 유무가 영향을 미치는 것으로 보인다.
  - Tokenize 할 때 N, V 즉, 동사와 명사류만을 뽑았는데 이 또한 영향을 미쳤으리라 짐작된다.
  - 낱말 사전에 없는 인터넷 용어들 (ex. 깨알, 골깜) 등과 어법에 맞지 않는 단어들이 단어 사전에서 (Okt, Mecab 등으로 tokenize할 때) 누락되는 것이 아닌가 하는 염려가 있다. 
- 평가
  - CNN을 활용해 Text Classification를 했다는 것 자체에 의의가 있다.
  - 모델 성능만을 따지면 꼭 전처리를 잘했다고 모델 성능이 좋은 것은 아니었다.
  - 하지만 예측을 할 때에는 전처리를 어떻게 하느냐가 예측 성능에 큰 영향을 미칠 것으로 판단된다.
  - 본 프로젝트에서는 성능을 높이는 것보다 구현 자체에 초점을 맞추었다.
  - 즉, 더 나은 모델을 만들고자 한다면 word_index에 들어갈 단어들을 정교하게 뽑아주어야 한다.
  - 또, 이것이 embedding_matrix의 단어들에 적절하게 반영이 되어있어야 한다.
- 아쉬운 점
  - 각각의 케이스마다 구현 코드가 조금씩 달라 클래스화 하는 데에 어려움이 있었다. 그래서 가능한 부분만 메서드화 하거나 재사용했다.
  - 구현에 초점을 맞추었다고 해도 전처리 부분에 아쉬움이 남는다.
  - 막상 써보니까 시간을 좀 더 들였다면 CNN모델을 스스로 짤 수도 있었을 것 같았다.

